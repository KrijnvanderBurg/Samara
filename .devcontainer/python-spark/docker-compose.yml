services:
    devcontainer:
        platform: linux/amd64
        build:
            context: .
            dockerfile: Dockerfile
            args:
                VARIANT: ubuntu-24.04
            target: base
        volumes:
            - ../../:/workspace:cached
            - devcontainer-bashhistory:/commandhistory
            - poetry-cache:/home/vscode/.cache/pypoetry
        command: sleep infinity

    jaeger:
        image: jaegertracing/all-in-one:latest
        platform: linux/amd64
        ports:
            - "16686:16686"  # Jaeger UI
            - "4317:4317"    # OTLP gRPC receiver
            - "4318:4318"    # OTLP HTTP receiver
        environment:
            - COLLECTOR_OTLP_ENABLED=true
            - LOG_LEVEL=info
        networks:
            - default

volumes:
    profile:
    devcontainer-bashhistory:
    poetry-cache:
